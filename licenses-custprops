# Extracts custom properties for licenses from FOLIO tenant
# and prints them in tab-delimited format
#
# for authentication, create file named okapi-login.json
# formatted as follows:
#
#  {
#    "tenant": "your_tenant",
#    "username": "your_username",
#    "password": "your_password"
#  }

tenant=$(cat tenant)
okapi_url=$(cat okapi.url)
okapi_token=$(cat okapi.token)

apicall=$(curl -s -w '\n' -X GET -D \
  -H "Accept: application/json" \
  -H "X-Okapi-Tenant: ${tenant}" \
  -H "x-okapi-token: ${okapi_token}" \
  ${okapi_url}/licenses/custprops)

echo "${apicall}" | jq -r '.[] |[.name, .description, ([ .category.values[]?.value ] |join(";") ) ] | @tsv' 


